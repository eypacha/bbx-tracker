var patron,sound,step=0,steps=2,tracker,loop=!0,bpm=80,minBpm=10,maxBpm=300;$(document).ready(function(){function n(){tracker=$("#tracker").val(),tracker=tracker.replace(/(\r\n|\n|\r)/gm," "),tracker=tracker.split(" ");for(var n=tracker.indexOf("");n>-1;)tracker.splice(n,1),n=tracker.indexOf("");$("#playBtn").addClass("collapse"),$("#stopBtn").removeClass("collapse"),patron=setInterval(function(){e()},3600/bpm*4),$(".tempo button").toggleDisabled()}function e(){sound.play(tracker[step]),step++,console.log(step),step>=tracker.length&&(loop?step=0:o())}function o(){clearInterval(patron),step=0,$("#playBtn").removeClass("collapse"),$("#stopBtn").addClass("collapse"),$(".tempo button").toggleDisabled()}function p(){loop?$("#loopBtn").addClass("noloop"):$("#loopBtn").removeClass("noloop"),loop=!loop}function t(n){0>n&&steps>1&&(bpm+=n),1>bpm&&(bpm=1),n>0&&maxBpm>bpm&&(bpm+=n),bpm>maxBpm&&(bpm=maxBpm),$("#bpm").html(bpm+" BPM")}function c(n){0>n&&bpm>minBpm&&(bpm+=n),minBpm>bpm&&(bpm=minBpm),n>0&&maxBpm>bpm&&(bpm+=n),bpm>maxBpm&&(bpm=maxBpm),$("#bpm").html(bpm+" BPM")}$("#playBtn").on("click",n),$("#stopBtn").on("click",o),$("#loopBtn").on("click",p),$("#tempoUp").on("click",function(){t(1)}),$("#tempoDown").on("click",function(){t(-1)}),$("#tempoUpUp").on("click",function(){t(10)}),$("#tempoDownDown").on("click",function(){t(-10)}),$("#moreSteps").on("click",function(){c(1)}),$("#lessSteps").on("click",function(){c(-1)}),sound=new Howl({src:["audio/sonidos.mp3"],sprite:{B:[48,300],Pf:[430,300],t:[1084,300],c:[3373,300],K:[2135,250],"^mmm":[3869,250],PPP:[5201,350]}}),$.fn.toggleDisabled=function(){return this.each(function(){var n=$(this);n.attr("disabled")?n.removeAttr("disabled"):n.attr("disabled","disabled")})}});