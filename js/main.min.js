function preload(){for(i=0;i<preload.arguments.length;i++)images[i]=new Image,images[i].src="img/pacha-"+preload.arguments[i]+".png"}var patron,sound,step=0,steps=2,tracker,loop=!0,bpm=80,minBpm=10,maxBpm=300,maxSteps=8,images=new Array,trackUrl;preload("boca-B-","boca-Pf","boca-ts","boca-c1","boca-c2","boca-c3","boca-^K","boca-^m","boca-BB","boca-Pa","boca-ió","boca-soy","boca-Pa","boca-Cha","boca-vi","boca-buen","boca-pfar","boca-ke","boca-cha","boca-ca","boca-bu","boca-co","ojos-1","ojos-2"),$(document).ready(function(){function a(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+a+"=([^&#]*)"),t=e.exec(location.search);return null===t?"":decodeURIComponent(t[1])}function s(){$("#shareBtn").addClass("collapse"),$("#waitingBox").removeClass("collapse");var a=LZString.compressToBase64($("#tracker").val());trackUrl="https://eypacha.github.io/bbx-tracker/?beat="+a+"&bpm="+bpm+"&steps="+steps,""==$("#shortlink").val()&&c(trackUrl,function(a){"undefined"==typeof a&&(a=trackUrl),$("#fbShare").attr("href","https://www.facebook.com/sharer/sharer.php?u="+a),$("#twShare").attr("href","https://twitter.com/share?url="+a+"&text=Escucha%20el%20beat%20que%20acabo%20de%20hacer!&hashtags=bbxtracker,beatbox,bbx&via=eypacha"),$("#btEmail").attr("href","mailto:?subject=Escucha el beat que acabo de hacer!&body=Beat hecho con BBX Tracker! > "+a),$("#shortlink").val(a),$("#shareIt").removeClass("collapse"),$("#waitingBox").addClass("collapse")})}function c(a,e){$.getJSON("https://api-ssl.bitly.com/v3/shorten?",{access_token:"4da3dd9ee59dfe487358e3d656aa6e2bcc1000eb",longUrl:a,format:"json"},function(a){console.log(a),e(a.data.url)})}function r(){tracker=$("#tracker").val(),tracker=tracker.replace(/(\r\n|\n|\r)/gm," "),tracker=tracker.split(" ");for(var a=tracker.indexOf("");a>-1;)tracker.splice(a,1),a=tracker.indexOf("");$("#playBtn").addClass("collapse"),$("#stopBtn").removeClass("collapse"),patron=setInterval(function(){p()},3600/bpm*16/steps),$(".tempo button").toggleDisabled(),$("#tracker").toggleDisabled(),$("#shortlink").val(""),$("#shareBtn").removeClass("collapse"),$("#shareIt").addClass("collapse"),$("#waitingBox").addClass("collapse")}function p(){var a=0;switch(step%4){case 1:a=1;break;case 3:a=2;break;case 2:case 0:default:a=0}$("#pacha").css("background-image","url('img/pacha-ojos-"+a+".png')"),$("#pacha div").css("background-image","url('img/pacha-boca-"+tracker[step]+".png')"),sound.play(tracker[step]),step++,step>=tracker.length&&(loop?step=0:n())}function n(){clearInterval(patron),step=0,ojos=0,$("#pacha div").css("background-image","url('img/pacha-boca---.png')"),$("#pacha").css("background-image","url('img/pacha-ojos-"+ojos+".png')"),$("#playBtn").removeClass("collapse"),$("#stopBtn").addClass("collapse"),$(".tempo button").toggleDisabled(),$("#tracker").toggleDisabled()}function l(){loop?$("#loopBtn").addClass("noloop"):$("#loopBtn").removeClass("noloop"),loop=!loop}function i(a){(0>a&&bpm>minBpm||a>0&&maxBpm>bpm)&&(bpm+=a),minBpm>bpm&&(bpm=minBpm),bpm>maxBpm&&(bpm=maxBpm),$("#bpm").html(bpm+" BPM")}function m(a){(0>a&&steps>1||a>0&&maxSteps>steps)&&(steps+=a),1>steps&&(steps=1),steps>maxSteps&&(steps=maxSteps),$("#steps").html("/ "+steps)}$("#playBtn").on("click",r),$("#stopBtn").on("click",n),$("#loopBtn").on("click",l),$("#tempoUp").on("click",function(){i(1)}),$("#tempoDown").on("click",function(){i(-1)}),$("#tempoUpUp").on("click",function(){i(10)}),$("#tempoDownDown").on("click",function(){i(-10)}),$("#moreSteps").on("click",function(){m(1)}),$("#lessSteps").on("click",function(){m(-1)}),$("#shareBtn").on("click",s),$("#shortBtn").on("click",s),sound=new Howl({src:["audio/sounds.mp3"],rate:1,sprite:{"B-":[48,300],Pf:[430,300],ts:[1084,300],c1:[2429,210],c2:[2666,300],c3:[3373,300],"^K":[2135,250],"^m":[3869,250],BB:[5201,350],"ió":[6055,350],soy:[6513,350],Pa:[6930,330],Cha:[7287,360],vi:[7697,350],buen:[8052,220],pfar:[8316,288],ke:[8651,101],cha:[8805,140],ca:[9024,189],bu:[9221,318],co:[9591,277]}});var e=a("beat");e.length>0&&$("#tracker").html(LZString.decompressFromBase64(e));var t=a("bpm");t.length>0&&t>=minBpm&&maxBpm>=t&&(bpm=parseInt(t),$("#bpm").html(bpm+" BPM"));var o=a("steps");o.length>0&&o>=2&&maxSteps>=o&&(steps=parseInt(o),$("#steps").html("/ "+steps)),$.fn.toggleDisabled=function(){return this.each(function(){var a=$(this);a.attr("disabled")?a.removeAttr("disabled"):a.attr("disabled","disabled")})}});